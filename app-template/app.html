<!DOCTYPE html>
<html>
<head lang="en">
    <title>J'inc!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="stylesheet/reset.css">
    <link rel="stylesheet" type="text/css" href="stylesheet/style.css">
</head>
<body>
    <div id="wallpaper" class="wallpaper">
        <div class="container">
            <header class="header">
                <h1 class="logo text"><a href="index.html">J'inc!</a></h1>
            </header>
            <div id="arrow" class="arrow-container rotate">
                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="arrow" viewBox="0 0 400 400">
                    <path d="M200,200 m-200, 0 a200,200 0 1,0 400,0 a200,200 0 1,0 -400,0 M200,20 l150,275 l-150,-55 l-150,55 l150,-275"/>
                </svg>
            </div>
            <footer id="distance" class="distance text">
                <p><span id="number" data-value="0">0</span><span id="unit" data-unit="metric">m</span></p>
            </footer>
        </div>
    </div>
    <script type="text/javascript" src="javascript/jinc-ui.js"></script>
    <script type="text/javascript" src="javascript/point.js"></script>
    <script type="text/javascript">
        document.getElementById('distance').onclick = ui.changeUnit;
        screen.mozLockOrientation("portrait-primary");

        var opera = point.create([
                48.870485,
                2.332379
            ]),
            house = point.create([
                48.843976,
                2.355059
            ]),
            work = point.create([
                48.869470,
                2.337584
            ]),
            eiffel = point.create([
                48.858363,
                2.294452
            ]),
            target = opera,
            me = false,
            delta = 0;

        if (window.location.hash === '#home') {
            target = house;
        }

        if (window.location.hash === '#opera') {
            target = opera;
        }

        if (window.location.hash === '#work') {
            target = work;
        }

        if (window.location.hash === '#eiffel') {
            target = eiffel;
        }

        document.body.onresize = ui.onResizeWindow;

        if ("geolocation" in navigator) {
            navigator.geolocation.watchPosition(function (position) {
                me = point.create(position.coords);
            });

            window.ondeviceorientation = function (event) {

                if (me !== false) {
                    delta = (me.getDelta(target, (360 - event.alpha)) * Math.PI / 180);
                    ui.printDistance(me.getDistance(target));
                }

                ui.arrow.rotate(delta);
            };
        }
    </script>
</body>
</html>